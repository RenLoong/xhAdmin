import{o as $,u as E}from"./index.98c37ab0.js";import{u as F}from"./app.e581b812.js";import{d as j,D as G,k as M,r as f,s as O,n as W,a as v,o as S,m as A,u as l,p as r,e,L as H,y as N,w as a,E as g,G as h,v as _,B as J,C as K}from"./.pnpm.cdfc085e.js";import{_ as Q}from"./_plugin-vue_export-helper.c27b6911.js";const V=m=>(J("data-v-4d19f460"),m=m(),K(),m),X={class:"database-container"},Y={key:0,class:"loading-container"},Z={class:"loading-box"},ee=V(()=>r("div",{class:"loading-text"}," 正在验证中... ",-1)),ae={class:"database"},te={key:0,class:"item"},le=V(()=>r("div",{class:"warning"},[r("div",null,"警告：在使用宝塔安装之前，请先在宝塔面板中进行开启API接口服务"),r("div",null,"接口开启步骤：宝塔->面板设置->API接口->开启，并且设置IP白名单为：127.0.0.1")],-1)),se={class:"item"},oe={class:"item"},ne={class:"item"},ue={class:"flex justify-between"},de={class:"item"},re={class:"action"},pe={class:"item"},ie={class:"item"},_e=j({__name:"index",props:{api:{}},setup(m){const L=m,R=F(),T=G(),x=M(),c={layout:"vertical"},I=f(!1),b=f({panel_port:"",panel_key:""}),P=f({server_port:"39600"}),d=f({type:"mysql",host:"127.0.0.1",username:"",database:"",password:"",port:"3306",prefix:"yc_",charset:"utf8mb4"}),y=f({username:"",password:""}),p=f({web_name:"",web_url:"",username:"",password:""}),C=f(!1),z=()=>{var i;const D={serverData:P.value,btData:b.value,database:d.value,cloud:y.value,site:p.value};C.value=!0,I.value=!0;const t=`${L.api}&c=${(i=x.query)==null?void 0:i.type}`;E(t,D).then(n=>{var u;const{data:o}=n;R.setData(o),$("/install",{type:(u=x.query)==null?void 0:u.type})}).catch(()=>{C.value=!1,I.value=!1})};return O(()=>{var o;if(!((o=x.query)==null?void 0:o.type)){W.error({message:"温馨提示",description:"请选择安装方式",duration:2}),T.push("/installType");return}const t=location.protocol,i=location.hostname,n=`${t}//${i}`;p.value.web_url=n}),(D,t)=>{var B;const i=v("a-divider"),n=v("a-input"),o=v("a-form-item"),u=v("a-col"),k=v("a-row"),w=v("a-form"),q=v("a-input-password"),U=v("a-button");return S(),A("div",X,[l(I)?(S(),A("div",Y,[r("div",Z,[e(l(H),{style:{"font-size":"38px"}}),ee])])):N("",!0),r("div",ae,[((B=l(x).query)==null?void 0:B.type)==="bt"?(S(),A("div",te,[e(i,{class:"title"},{default:a(()=>[_(" 宝塔服务设置 ")]),_:1}),e(w,g(h(c)),{default:a(()=>[e(k,{gutter:30},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(o,{label:"面板端口号",name:"panel_port"},{default:a(()=>[e(n,{value:l(b).panel_port,"onUpdate:value":t[0]||(t[0]=s=>l(b).panel_port=s),"addon-before":"http://您的服务器IP:",placeholder:"面板地址后面的端口号，示例：8888"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{label:"宝塔API密钥",name:"panel_key"},{default:a(()=>[e(n,{value:l(b).panel_key,"onUpdate:value":t[1]||(t[1]=s=>l(b).panel_key=s),placeholder:"请输入宝塔API密钥"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},16),le])):N("",!0),r("div",se,[e(i,{class:"title"},{default:a(()=>[_(" 框架服务 ")]),_:1}),e(w,g(h(c)),{default:a(()=>[e(k,{gutter:30},{default:a(()=>[e(u,{span:24},{default:a(()=>[e(o,{label:"启动端口（默认39600）",name:"server_port"},{default:a(()=>[e(n,{value:l(P).server_port,"onUpdate:value":t[2]||(t[2]=s=>l(P).server_port=s),placeholder:"启动端口服务"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},16)]),r("div",oe,[e(i,{class:"title"},{default:a(()=>[_(" 数据库设置 ")]),_:1}),e(w,g(h(c)),{default:a(()=>[e(k,{gutter:30},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(o,{label:"数据库类型",name:"mysql"},{default:a(()=>[e(n,{value:l(d).type,"onUpdate:value":t[3]||(t[3]=s=>l(d).type=s),placeholder:"请输入数据库类型",disabled:""},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{label:"数据库主机",name:"host"},{default:a(()=>[e(n,{value:l(d).host,"onUpdate:value":t[4]||(t[4]=s=>l(d).host=s),placeholder:"请输入数据库主机"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{label:"数据库名称",name:"database"},{default:a(()=>[e(n,{value:l(d).database,"onUpdate:value":t[5]||(t[5]=s=>l(d).database=s),placeholder:"请输入数据库名称"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{label:"数据库用户",name:"db_user"},{default:a(()=>[e(n,{value:l(d).username,"onUpdate:value":t[6]||(t[6]=s=>l(d).username=s),placeholder:"请输入数据库用户"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{label:"数据库密码",name:"db_pass"},{default:a(()=>[e(q,{value:l(d).password,"onUpdate:value":t[7]||(t[7]=s=>l(d).password=s),placeholder:"请输入数据库密码"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{label:"数据库端口",name:"port"},{default:a(()=>[e(n,{value:l(d).port,"onUpdate:value":t[8]||(t[8]=s=>l(d).port=s),placeholder:"请输入安全端口"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{label:"数据表前缀",name:"prefix"},{default:a(()=>[e(n,{value:l(d).prefix,"onUpdate:value":t[9]||(t[9]=s=>l(d).prefix=s),placeholder:"请输入数据表前缀"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{label:"数据字符集",name:"charset"},{default:a(()=>[e(n,{value:l(d).charset,"onUpdate:value":t[10]||(t[10]=s=>l(d).charset=s),placeholder:"请输入数据字符集",disabled:""},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},16)]),r("div",ne,[e(i,{class:"title"},{default:a(()=>[_(" 云服务登录 ")]),_:1}),e(w,g(h(c)),{default:a(()=>[e(o,{label:"登录账号",name:"cloud_user"},{default:a(()=>[e(n,{value:l(y).username,"onUpdate:value":t[11]||(t[11]=s=>l(y).username=s),placeholder:"请输入云服务账号"},null,8,["value"])]),_:1}),e(o,{label:"登录密码",name:"cloud_pass"},{default:a(()=>[e(q,{value:l(y).password,"onUpdate:value":t[12]||(t[12]=s=>l(y).password=s),placeholder:"请输入云服务登录密码"},null,8,["value"])]),_:1}),r("div",ue,[e(U,{href:"http://www.kfadmin.net//#/register",target:"_blank",type:"link"},{default:a(()=>[_(" 注册账号 ")]),_:1}),e(U,{href:"http://www.kfadmin.net/#/forgot",target:"_blank",type:"link"},{default:a(()=>[_(" 忘记密码 ")]),_:1})])]),_:1},16)]),r("div",de,[e(i,{class:"title"},{default:a(()=>[_(" 站点设置 ")]),_:1}),e(w,g(h(c)),{default:a(()=>[e(k,{gutter:30},{default:a(()=>[e(u,{span:12},{default:a(()=>[e(o,{label:"站点名称",name:"web_name"},{default:a(()=>[e(n,{value:l(p).web_name,"onUpdate:value":t[13]||(t[13]=s=>l(p).web_name=s),placeholder:"请输入站点名称"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{label:"站点域名（结尾不带斜杠）",disabled:"",name:"domain"},{default:a(()=>[e(n,{value:l(p).web_url,"onUpdate:value":t[14]||(t[14]=s=>l(p).web_url=s),placeholder:"请输入站点域名"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{label:"管理员账号",name:"username"},{default:a(()=>[e(n,{value:l(p).username,"onUpdate:value":t[15]||(t[15]=s=>l(p).username=s),placeholder:"请输入管理员账号"},null,8,["value"])]),_:1})]),_:1}),e(u,{span:12},{default:a(()=>[e(o,{label:"管理员密码",name:"password"},{default:a(()=>[e(q,{value:l(p).password,"onUpdate:value":t[16]||(t[16]=s=>l(p).password=s),placeholder:"请输入管理员密码"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},16)])]),r("div",re,[r("div",pe,[e(U,{type:"primary",onClick:t[17]||(t[17]=s=>l($)("/installType"))},{default:a(()=>[_(" 上一步 ")]),_:1})]),r("div",ie,[e(U,{type:"primary",disabled:l(C),danger:"",onClick:z},{default:a(()=>[_(" 下一步 ")]),_:1},8,["disabled"])])])])}}});const be=Q(_e,[["__scopeId","data-v-4d19f460"]]);export{be as default};
