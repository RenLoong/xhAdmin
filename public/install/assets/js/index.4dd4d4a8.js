import{o as i,u as r}from"./index.47b5e7ec.js";import{u as k}from"./app.498162da.js";import{d as I,k as D,r as h,H as F,s as R,n as w,o as d,m,F as B,q as C,u as H,t as S}from"./.pnpm.806cdd1d.js";import{_ as T}from"./_plugin-vue_export-helper.c27b6911.js";const A=I({__name:"index",props:{api:{}},setup(x){const l=x,q=k(),o=D(),c=q.getData(),n=h([]),u=h(),$=()=>{var s;const e=`${l.api}&step=config&c=${(s=o.query)==null?void 0:s.type}`;r(e,c).then(a=>{const t=a==null?void 0:a.msg;n.value.push(t??"安装错误"),setTimeout(()=>{var p;i("/complete",{type:(p=o.query)==null?void 0:p.type})},2500)})},b=()=>{var s;const e=`${l.api}&step=database&c=${(s=o.query)==null?void 0:s.type}`;r(e,c).then(a=>{const t=a==null?void 0:a.msg;n.value.push(t??"安装错误"),$()})},f=(e=0)=>{var a;const s=`${l.api}&step=structure&total=${e}&c=${(a=o.query)==null?void 0:a.type}`;r(s,c).then(t=>{var _,y,g,v;const p=t==null?void 0:t.msg;n.value.push(p??"安装错误"),((_=t.data)==null?void 0:_.next)==="structure"&&((y=t.data)!=null&&y.total)&&f((g=t.data)==null?void 0:g.total),((v=t.data)==null?void 0:v.next)==="database"&&b()}).catch(()=>{var t;i("/database",{type:(t=o.query)==null?void 0:t.type})})};return F(n.value,()=>{u.value.scrollTo(0,u.value.scrollHeight)}),R(()=>{if(!c){w.error({message:"温馨提示",description:"请先填写安装数据",duration:2,onClose(){var e;i("/database",{type:(e=o.query)==null?void 0:e.type})}});return}f()}),(e,s)=>(d(),m("div",{ref_key:"installRef",ref:u,class:"install-box"},[(d(!0),m(B,null,C(H(n),(a,t)=>(d(),m("div",{key:t,class:"item"},S(a),1))),128))],512))}});const W=T(A,[["__scopeId","data-v-5694904f"]]);export{W as default};
