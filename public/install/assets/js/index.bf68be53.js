import{o as $,u as F}from"./index.712e9451.js";import{u as H}from"./app.d36ffa8d.js";import{d as j,D as G,k as M,r as m,s as O,n as W,a as i,o as q,m as A,u as t,p as d,e,L as J,y as N,w as a,E as k,G as g,v,B as K,C as Q}from"./.pnpm.f2f3c7ce.js";import{_ as X}from"./_plugin-vue_export-helper.c27b6911.js";const V=c=>(K("data-v-11707077"),c=c(),Q(),c),Y={class:"database-container"},Z={key:0,class:"loading-container"},ee={class:"loading-box"},ae=V(()=>d("div",{class:"loading-text"}," 正在验证中... ",-1)),le={class:"database"},te={key:0,class:"item"},se=V(()=>d("div",{class:"warning"},[d("div",null,"温馨提示：密钥仅用于本次安装，猿创科技不会保存您的密钥，请安装完成后手动关闭宝塔的API接口"),d("div",null,"警告：在使用宝塔安装之前，请先在宝塔面板中进行开启API接口服务"),d("div",null,"接口开启步骤：宝塔->面板设置->API接口->开启，并且设置IP白名单为：127.0.0.1")],-1)),oe={class:"item"},ne={class:"item"},ue={class:"item"},de={class:"flex justify-between"},pe={class:"item"},re={class:"action"},_e={class:"item"},ie={class:"item"},ve=j({__name:"index",props:{api:{}},setup(c){const L=c,R=H(),z=G(),x=M(),b={layout:"vertical"},I=m(!1),f=m({panel_ssl:"0",panel_port:"",panel_key:""}),C=m({server_port:"39600"}),u=m({type:"mysql",host:"127.0.0.1",username:"",database:"",password:"",port:"3306",prefix:"yc_",charset:"utf8mb4"}),y=m({username:"",password:""}),r=m({web_name:"",web_url:"",username:"",password:""}),D=m(!1),E=()=>{var _;const S={serverData:C.value,btData:f.value,database:u.value,cloud:y.value,site:r.value};D.value=!0,I.value=!0;const l=`${L.api}&c=${(_=x.query)==null?void 0:_.type}`;F(l,S).then(w=>{var n;const{data:o}=w;R.setData(o),$("/install",{type:(n=x.query)==null?void 0:n.type})}).catch(()=>{D.value=!1,I.value=!1})};return O(()=>{var o;if(!((o=x.query)==null?void 0:o.type)){W.error({message:"温馨提示",description:"请选择安装方式",duration:2}),z.push("/installType");return}const l=location.protocol,_=location.hostname,w=`${l}//${_}`;r.value.web_url=w}),(S,l)=>{var B;const _=i("a-divider"),w=i("a-switch"),o=i("a-form-item"),n=i("a-col"),p=i("a-input"),U=i("a-row"),h=i("a-form"),T=i("a-input-password"),P=i("a-button");return q(),A("div",Y,[t(I)?(q(),A("div",Z,[d("div",ee,[e(t(J),{style:{"font-size":"38px"}}),ae])])):N("",!0),d("div",le,[((B=t(x).query)==null?void 0:B.type)==="bt"?(q(),A("div",te,[e(_,{class:"title"},{default:a(()=>[v(" 宝塔服务设置 ")]),_:1}),e(h,k(g(b)),{default:a(()=>[e(U,{gutter:30},{default:a(()=>[e(n,{span:3},{default:a(()=>[e(o,{label:"面板协议",name:"panel_ssl"},{default:a(()=>[e(w,{checked:t(f).panel_ssl,"onUpdate:checked":l[0]||(l[0]=s=>t(f).panel_ssl=s),"un-checked-value":"0","un-checked-children":"HTTP","checked-value":"1","checked-children":"HTTPS"},null,8,["checked"])]),_:1})]),_:1}),e(n,{span:9},{default:a(()=>[e(o,{label:"面板端口号",name:"panel_port"},{default:a(()=>[e(p,{value:t(f).panel_port,"onUpdate:value":l[1]||(l[1]=s=>t(f).panel_port=s),"addon-before":"http://服务器IP:",placeholder:"示例：8888"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{label:"宝塔API密钥",name:"panel_key"},{default:a(()=>[e(p,{value:t(f).panel_key,"onUpdate:value":l[2]||(l[2]=s=>t(f).panel_key=s),placeholder:"请输入宝塔API密钥"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},16),se])):N("",!0),d("div",oe,[e(_,{class:"title"},{default:a(()=>[v(" 框架服务 ")]),_:1}),e(h,k(g(b)),{default:a(()=>[e(U,{gutter:30},{default:a(()=>[e(n,{span:24},{default:a(()=>[e(o,{label:"启动端口（默认39600）",name:"server_port"},{default:a(()=>[e(p,{value:t(C).server_port,"onUpdate:value":l[3]||(l[3]=s=>t(C).server_port=s),placeholder:"启动端口服务"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},16)]),d("div",ne,[e(_,{class:"title"},{default:a(()=>[v(" 数据库设置 ")]),_:1}),e(h,k(g(b)),{default:a(()=>[e(U,{gutter:30},{default:a(()=>[e(n,{span:12},{default:a(()=>[e(o,{label:"数据库类型",name:"mysql"},{default:a(()=>[e(p,{value:t(u).type,"onUpdate:value":l[4]||(l[4]=s=>t(u).type=s),placeholder:"请输入数据库类型",disabled:""},null,8,["value"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{label:"数据库主机",name:"host"},{default:a(()=>[e(p,{value:t(u).host,"onUpdate:value":l[5]||(l[5]=s=>t(u).host=s),placeholder:"请输入数据库主机"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{label:"数据库名称",name:"database"},{default:a(()=>[e(p,{value:t(u).database,"onUpdate:value":l[6]||(l[6]=s=>t(u).database=s),placeholder:"请输入数据库名称"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{label:"数据库用户",name:"db_user"},{default:a(()=>[e(p,{value:t(u).username,"onUpdate:value":l[7]||(l[7]=s=>t(u).username=s),placeholder:"请输入数据库用户"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{label:"数据库密码",name:"db_pass"},{default:a(()=>[e(T,{value:t(u).password,"onUpdate:value":l[8]||(l[8]=s=>t(u).password=s),placeholder:"请输入数据库密码"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{label:"数据库端口",name:"port"},{default:a(()=>[e(p,{value:t(u).port,"onUpdate:value":l[9]||(l[9]=s=>t(u).port=s),placeholder:"请输入安全端口"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{label:"数据表前缀",name:"prefix"},{default:a(()=>[e(p,{value:t(u).prefix,"onUpdate:value":l[10]||(l[10]=s=>t(u).prefix=s),placeholder:"请输入数据表前缀"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{label:"数据字符集",name:"charset"},{default:a(()=>[e(p,{value:t(u).charset,"onUpdate:value":l[11]||(l[11]=s=>t(u).charset=s),placeholder:"请输入数据字符集",disabled:""},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},16)]),d("div",ue,[e(_,{class:"title"},{default:a(()=>[v(" 云服务登录 ")]),_:1}),e(h,k(g(b)),{default:a(()=>[e(o,{label:"登录账号",name:"cloud_user"},{default:a(()=>[e(p,{value:t(y).username,"onUpdate:value":l[12]||(l[12]=s=>t(y).username=s),placeholder:"请输入云服务账号"},null,8,["value"])]),_:1}),e(o,{label:"登录密码",name:"cloud_pass"},{default:a(()=>[e(T,{value:t(y).password,"onUpdate:value":l[13]||(l[13]=s=>t(y).password=s),placeholder:"请输入云服务登录密码"},null,8,["value"])]),_:1}),d("div",de,[e(P,{href:"http://www.kfadmin.net//#/register",target:"_blank",type:"link"},{default:a(()=>[v(" 注册账号 ")]),_:1}),e(P,{href:"http://www.kfadmin.net/#/forgot",target:"_blank",type:"link"},{default:a(()=>[v(" 忘记密码 ")]),_:1})])]),_:1},16)]),d("div",pe,[e(_,{class:"title"},{default:a(()=>[v(" 站点设置 ")]),_:1}),e(h,k(g(b)),{default:a(()=>[e(U,{gutter:30},{default:a(()=>[e(n,{span:12},{default:a(()=>[e(o,{label:"站点名称",name:"web_name"},{default:a(()=>[e(p,{value:t(r).web_name,"onUpdate:value":l[14]||(l[14]=s=>t(r).web_name=s),placeholder:"请输入站点名称"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{label:"站点域名（结尾不带斜杠）",disabled:"",name:"domain"},{default:a(()=>[e(p,{value:t(r).web_url,"onUpdate:value":l[15]||(l[15]=s=>t(r).web_url=s),placeholder:"请输入站点域名"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{label:"管理员账号",name:"username"},{default:a(()=>[e(p,{value:t(r).username,"onUpdate:value":l[16]||(l[16]=s=>t(r).username=s),placeholder:"请输入管理员账号"},null,8,["value"])]),_:1})]),_:1}),e(n,{span:12},{default:a(()=>[e(o,{label:"管理员密码",name:"password"},{default:a(()=>[e(T,{value:t(r).password,"onUpdate:value":l[17]||(l[17]=s=>t(r).password=s),placeholder:"请输入管理员密码"},null,8,["value"])]),_:1})]),_:1})]),_:1})]),_:1},16)])]),d("div",re,[d("div",_e,[e(P,{type:"primary",onClick:l[18]||(l[18]=s=>t($)("/installType"))},{default:a(()=>[v(" 上一步 ")]),_:1})]),d("div",ie,[e(P,{type:"primary",disabled:t(D),danger:"",onClick:E},{default:a(()=>[v(" 下一步 ")]),_:1},8,["disabled"])])])])}}});const ye=X(ve,[["__scopeId","data-v-11707077"]]);export{ye as default};
