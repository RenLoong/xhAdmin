import{u as P,a as A,r as d,b as H,d as U,g as $,e as j,o as r,c as u,f as s,h as z,i as m,w as f,j as D,k as S,l as L,n as M,m as T,p as W,q as F}from"./index-5b8d1ef5.js";import{_ as G}from"./index-d7171efa.js";import{_ as J}from"./_plugin-vue_export-helper-c27b6911.js";import"./useMsg-a3b77632.js";import"./useConfirm-3d0e55d8.js";import"./UploadifyPicture-39e0413f.js";const c=n=>(W("data-v-5713f574"),n=n(),F(),n),K={class:"form-box"},O={key:0,class:"top-button"},Q={key:2,class:"button-container"},X=c(()=>s("span",{class:"fa fa-edit pr-1"},null,-1)),Y=c(()=>s("span",null,"提交",-1)),Z=c(()=>s("span",{class:"fa fa-times pr-1"},null,-1)),ee=c(()=>s("span",null,"重置",-1)),ae={key:3,class:"loading-container"},te=c(()=>s("div",{class:"loading-box"},[s("div",{class:"fa fa-spinner fa-pulse"}),s("div",{class:"loading-text"},"加载中...")],-1)),se=[te],oe={__name:"index",props:{mainBodyHeight:Number},setup(n){var g,k;const q=P(),e=A(),h=e.fullPath,B=e.path.slice(1),a=d({api:"",method:"",params:{}}),p=d(null),_=d(!1),l=d(!1),C=q.getApiMenus(),I=H(()=>{var t;return!!((t=e==null?void 0:e.query)!=null&&t.redirect)});var v=U(B,C,"path_text");if(v!==void 0){a.value=v;var i={};h.includes("?")&&(i=$(h),i.redirect&&delete i.redirect);const t=(g=a.value)!=null&&g.auth_params?(k=a.value)==null?void 0:k.auth_params:{};a.value.params={...i,...t}}else console.error("菜单请求地址错误");const N=()=>{l.value=!0,p.value.hanldSubmit()},R=()=>{p.value.hanldReset()},V=()=>{l.value=!1,y()},w=()=>{l.value=!1},E=()=>{_.value=!0},y=()=>{var o,b;const t=(o=e.query)==null?void 0:o.redirect;if(!t)return;(b=e==null?void 0:e.query)==null||delete b.redirect;const x=e==null?void 0:e.query;T(t,x)};return(t,x)=>{const o=j("el-button");return r(),u("div",{class:"form-create",style:M(`height:${n.mainBodyHeight}px`)},[s("div",K,[z(I)&&_.value?(r(),u("div",O,[m(o,{type:"primary",onClick:y},{default:f(()=>[D("返回")]),_:1})])):S("",!0),a.value.path?(r(),L(G,{key:1,ref_key:"formRef",ref:p,api:a.value.path,method:a.value.method,"query-params":a.value.params,onInit:E,onSuccess:V,onError:w},null,8,["api","method","query-params"])):S("",!0),_.value?(r(),u("div",Q,[m(o,{type:"primary",onClick:N,loading:l.value},{default:f(()=>[X,Y]),_:1},8,["loading"]),m(o,{type:"danger",onClick:R},{default:f(()=>[Z,ee]),_:1})])):(r(),u("div",ae,se))])],4)}}},ue=J(oe,[["__scopeId","data-v-5713f574"]]);export{ue as default};
